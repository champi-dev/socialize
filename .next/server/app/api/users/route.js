"use strict";(()=>{var e={};e.id=701,e.ids=[701],e.modules={1185:e=>{e.exports=require("mongoose")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},6698:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>w,patchFetch:()=>y,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>g});var n={};r.r(n),r.d(n,{GET:()=>p});var a=r(5419),o=r(9108),s=r(9678),i=r(8070),u=r(2345),l=r(5665);async function p(e){try{if(!process.env.MONGODB_URI)return i.Z.json({error:"Database not configured"},{status:503});await (0,u.Z)();let{searchParams:t}=new URL(e.url),r=parseInt(t.get("limit")||"10"),n=parseInt(t.get("page")||"1"),a=t.get("search"),o={};a&&(o={$or:[{username:{$regex:a,$options:"i"}},{displayName:{$regex:a,$options:"i"}}]});let s=await l.Z.find(o).select("-password").limit(r).skip((n-1)*r).sort({createdAt:-1}),p=await l.Z.countDocuments(o);return i.Z.json({users:s,pagination:{page:n,limit:r,total:p,pages:Math.ceil(p/r)}})}catch(e){return console.error("Users fetch error:",e),i.Z.json({error:"Internal server error"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/users/route",pathname:"/api/users",filename:"route",bundlePath:"app/api/users/route"},resolvedPagePath:"/Users/champi/Development/socialize/app/api/users/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:c,staticGenerationAsyncStorage:m,serverHooks:h,headerHooks:f,staticGenerationBailout:g}=d,w="/api/users/route";function y(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},5665:(e,t,r)=>{r.d(t,{Z:()=>p});var n=r(1185),a=r.n(n),o=r(6521),s=r.n(o),i=r(6082),u=r.n(i);let l=new(a()).Schema({username:{type:String,required:!0,unique:!0,trim:!0,minlength:3,maxlength:30,match:/^[a-zA-Z0-9_]+$/},email:{type:String,required:!0,unique:!0,lowercase:!0,trim:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0,minlength:6},displayName:{type:String,required:!0,trim:!0,maxlength:50},bio:{type:String,maxlength:160,default:""},avatar:{type:String,default:null},coverImage:{type:String,default:null},followers:[{type:a().Schema.Types.ObjectId,ref:"User"}],following:[{type:a().Schema.Types.ObjectId,ref:"User"}],isVerified:{type:Boolean,default:!1},isPrivate:{type:Boolean,default:!1},createdAt:{type:Date,default:Date.now},lastActive:{type:Date,default:Date.now}});l.pre("save",async function(e){if(!this.isModified("password"))return e();try{let t=await s().genSalt(10);this.password=await s().hash(this.password,t),e()}catch(t){e(t)}}),l.methods.comparePassword=async function(e){return await s().compare(e,this.password)},l.methods.generateAuthToken=function(){let e=process.env.JWT_SECRET;if(!e)throw Error("JWT_SECRET is not defined");return u().sign({_id:this._id.toString(),username:this.username},e,{expiresIn:"30d"})},l.methods.toJSON=function(){let e=this.toObject();return delete e.password,e};let p=a().models.User||a().model("User",l)},2345:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(1185),a=r.n(n);let o=process.env.MONGODB_URI;o||console.warn("MONGODB_URI is not defined - database features will not work");let s=global.mongoose;s||(s=global.mongoose={conn:null,promise:null});let i=async function(){if(!o)throw Error("MONGODB_URI is not defined in environment variables");if(s.conn)return s.conn;s.promise||(s.promise=a().connect(o,{bufferCommands:!1}).then(e=>e));try{s.conn=await s.promise}catch(e){throw s.promise=null,e}return s.conn}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,206,145],()=>r(6698));module.exports=n})();